<!DOCTYPE html>
<html>
<head>
    <title><Editor>Homepage</Editor></title>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <!-- Dark Barrier -->
    <div class="Dark-Barrier" onclick="sidebar()"></div>
    
    <!-- Sidebar -->
    <div class="w3-sidebar w3-bar-block Sidebar">
        <a href="javascript:sidebar()" class="w3-bar-item w3-button">Close</a>
        <a href="javascript:newdoc()" class="w3-bar-item w3-button">New Doc</a>
        <a href="javascript:showfiles()" class="w3-bar-item w3-button">Files</a>
        <a href="javascript:settings()" class="w3-bar-item w3-button">Settings</a>
    </div>
    
    <!-- Navigation -->
    <div class="w3-bar w3-white" style="width: 100%; font-size: 1.2rem">
        <a href="javascript:void()" onclick="sidebar()" class="w3-bar-item w3-button"><i class="material-icons" style="zoom: 1.2">menu</i></a>
        <a href="javascript:save()" class="w3-bar-item w3-button"><i class="material-icons" style="zoom: 1.2">save</i></a>
        <a href="https://pascal-the-elf.github.io/Editor/" class="w3-bar-item w3-button w3-right"><b>&lt;/Editor&gt;</b></a>
    </div>
    
    <!-- Editor -->
    <div class="Editor-Container">
        <textarea class="Editor w3-code w3-round w3-card notranslate" rows="18" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
    </div>
    
    <!-- Doc Helper-->
    <div class="Doc-Helper" onclick="newdoc()">
        <div class="container w3-round dhc">
            <div class="w3-panel w3-round w3-light-gray w3-margin pointer">
                <p>HTML</p>
            </div>
            <div class="html-collection" style="height: 0px; transition: height 0.5s; overflow: hidden;">
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(0, 0);newdoc()">
                    <p>Plain HTML</p>
                </div>
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(0, 1);newdoc()">
                    <p>HTML with Copyright</p>
                </div>
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(0, 2);newdoc()">
                    <p>HTML with Script & CSS</p>
                </div>
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(0, 3);newdoc()">
                    <p>HTML with W3.CSS</p>
                </div>
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(0, 4);newdoc()">
                    <p>HTML with Bootstrap</p>
                </div>
            </div>
            <div class="w3-panel w3-round w3-light-gray w3-margin pointer">
                <p>Javascript</p>
            </div>
            <div class="javascript-collection" style="height: 0px; transition: height 0.5s; overflow: hidden;">
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(1, 0);newdoc()">
                    <p>Plain Javascript</p>
                </div>
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(1, 1);newdoc()">
                    <p>Javascript with Copyright</p>
                </div>
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(1, 2);newdoc()">
                    <p>Use Strict</p>
                </div>
            </div>
            <div class="w3-panel w3-round w3-light-gray w3-margin pointer">
                <p>CSS</p>
            </div>
            <div class="css-collection" style="height: 0px; transition: height 0.5s; overflow: hidden;">
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(2, 0);newdoc()">
                    <p>Plain CSS</p>
                </div>
                <div class="w3-panel w3-round w3-white w3-border w3-margin pointer" onclick="Template(2, 1);newdoc()">
                    <p>CSS with Copyright</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- File Browser -->
    <div class="File-Browser" onclick="showfiles()">
        <div class="container w3-round fbc">
            
        </div>
    </div>
    
    <!-- Settings Page -->
    <div class="Settings-Page" onclick="settings()">
        <div class="container w3-round spc">
            
        </div>
    </div>
    
    
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: white;
        }
        .Dark-Barrier {
            z-index: 10;
            width: 100vw;
            height: 100vh;
            position: fixed;
            display: none;
            top: 0;
            left: 0;
            background-color: rgba(0, 0, 0, .0);
            transition: background-color 0.5s;
        }
        .Sidebar {
            z-index: 20;
            position: fixed;
            left: -200px;
            width: 200px;
            background-color: white;
            transition: left 0.5s;
        }
        .Editor-Container {
            margin: 0 16px;
        }
        .Editor {
            width: 100%;
            background-color: #41444e;
            color: #fff;
            font-weight: 500;
            font-family: 'Source Code Pro', monospace;
            font-size: 18px;
        }
        ::selection{
            background: #88aadd;
        }
        .Doc-Helper, .File-Browser, .Settings-Page {
            z-index: 30;
            width: 100%;
            height: 100%;
            position: fixed;
            top: 0;
            left: 0;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, .6);
            transition: background-color 0.5s;
        }
        .Doc-Helper > .container, .File-Browser > .container, .Settings-Page > .container {
            width: 85%;
            height: 90%;
            max-width: 800px;
            background: white;
            overflow: auto;
        }
        .pointer {
            cursor: pointer;
        }
    </style>
    <script>
        var editor = elm("Editor");
        
        // prevent unwantted window closures
        elm("dhc").addEventListener("click", e => {
            e.stopPropagation();
        }, false);
        elm("fbc").addEventListener("click", e => {
            e.stopPropagation();
        }, false);
        elm("spc").addEventListener("click", e => {
            e.stopPropagation();
        }, false);
        
        // open / close doc options
        elm("dhc").children[0].addEventListener("click", e => {
            elm("html-collection").style.height == "0px" ? elm("html-collection").style.height = "375px" : elm("html-collection").style.height = "0px";
        });
        elm("dhc").children[2].addEventListener("click", e => {
            elm("javascript-collection").style.height == "0px" ? elm("javascript-collection").style.height = "225px" : elm("javascript-collection").style.height = "0px";
        });
        elm("dhc").children[4].addEventListener("click", e => {
            elm("css-collection").style.height == "0px" ? elm("css-collection").style.height = "150px" : elm("css-collection").style.height = "0px";
        });
        
        // load opened file into Editor
        if(localStorage["editor-opened"]) {
            editor.value = JSON.parse(localStorage["editor-file-"+localStorage["editor-opened"]]).content;
        }
        
        function sidebar() {
            if(elm("Sidebar").style.left == "-200px") {
                elm("Sidebar").style.left = "0px";
                elm("Dark-Barrier").style.display = "block";
                elm("Dark-Barrier").style.backgroundColor = "rgba(0, 0, 0, .6)";
            }
            else {
                elm("Sidebar").style.left = "-200px"
                setTimeout(function(){elm("Dark-Barrier").style.display = "none";}, 500);
                elm("Dark-Barrier").style.backgroundColor = "rgba(0, 0, 0, .0)";
            }
        }
        function newdoc() {
            if(elm("Doc-Helper").style.display == "none") {
                sidebar();
                elm("Doc-Helper").style.display = "flex";
            }
            else {
                elm("Doc-Helper").style.display = "none";
            }
        }
        function showfiles() {
            if(elm("File-Browser").style.display == "none") {
                sidebar();
                elm("File-Browser").style.display = "flex";
            }
            else {
                elm("File-Browser").style.display = "none";
            }
        }
        function settings() {
            if(elm("Settings-Page").style.display == "none") {
                sidebar();
                elm("Settings-Page").style.display = "flex";
            }
            else {
                elm("Settings-Page").style.display = "none";
            }
        }
        function elm(cls) {
            return document.getElementsByClassName(cls)[0];
        }
        function files() {
            if(!localStorage["editor-files"]) localStorage["editor-files"] = "[]";
            return JSON.parse(localStorage["editor-files"]);
        }
        function file(id) {
            if(localStorage["editor-file-"+id]) return JSON.parse(localStorage["editor-file-"+id]);
            return null;
        }
        function createfile(type, name) {
            var list = files();
            var fet = Date.now();
            var file = {
                type: type,
                name: name,
                content: "",
                lastEdit: fet,
                firstEdit: fet
            };
            list.push(fet);
            localStorage["editor-files"] = JSON.stringify(list);
            localStorage["editor-file-"+fet] = JSON.stringify(file);
            console.log("File System: Created File. "+fet);
            console.log(file);
        }
        function savefile(id, type, name, content) {
            var file = JSON.parse(localStorage["editor-file-"+id]);
            file.type = type;
            file.name = name;
            file.content = content;
            file.lastEdit = Date.now();
            localStorage["editor-file-"+id] = JSON.stringify(file);
            console.log("File System: Updated File. "+id);
            console.log(file);
        }
        function deletefile(id) {
            localStorage.removeItem("editor-file-"+id);
            var list = files();
            var loc = -1;
            for(var i = 0; i < list.length; i++)
                if(list[i] == id) loc = i;
            if(loc != -1) {
                list.splice(loc, 1);
                localStorage["editor-files"] = JSON.stringify(list);
                console.log("File System: Deleted File. "+id);
            }
        }
        function Template(mod, type) {
            console.log("Template: Fetching Template. " + "./templates/"+mod+"/"+type+".template");
            fetch("./templates/"+mod+"/"+type+".template").then(r=>r.text()).then(t=>editor.value = t);
            console.log("Template: Completed.");
        }
        /*
{
type: "html" || "javascript" || "css" || "plain text",
name: FILENAME,
content: FILECONTENT,
lastEdit: MS,
firstEdit: MS
}
        */
    </script>
</body>
</html>
